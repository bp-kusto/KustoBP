[`🌐 КОНТЕКСТ`](./ProcData/context.md)   [`⚙️ СЦЕНАРІЇ`](./ProcData/scripts.md)  

# Демо процес [<sup>📥 завантажити</sub>](./Sources/P25076j__SampleProcess.zip)

Процес створено для демонтстрації підходу до розробки бізнес-процесів ELMA

![DemoProc_Map](./img/DemoProc_Map.png)

### 🔶 Найменування об'єктів процесу

#### 🔷 Нумерування зон відповідальності

◻️ Назва зон відповідальності на діаграмі процесу починається з їх порядкового номеру у форматі `ZZ`, де ZZ - двоцифровий номер зони процесу (у відповідності до послідовності виконання задач процесу) -- що буде використано для привязки назв задач, скриптів, тощо. Нумерація зон відповідальності процесу проводиться з кроком 10 (`10 • Ініціатор`, `20 • Економіст`, `30 • Директор`)
> Таким чином за необхідності внесення нової зони в процес її буде легко вставити між існуючими зберігши послідовність виконання задач процесу, та не переробляючи назви інших зон, задач та скриптів.

#### 🔷 Нумерування задач процесу

◻️ Назва задач на діаграмі процесу починається теж з іх порядкового номеру в форматі `ZZTT` де ZZ - двоцифровий номер зони процесу в якій міститься задача, TT - двоцифровий номер задачі. Частина TT в номері задачі (для наступної задачі в цій же ж зоні), як і в нумерації зон процесу теж зростає на 10 (щоб була можливість вставити нову задачу між існуючими): `[1010] 📥 Підготовка 👤 Ініціатор` (зона 10, задача 10), `[1020] 📥 Усунення зауважень 👤 Ініціатор` (зона 10, задача 20), `[2010] 📥 Заключення 👤 Економіст` (зона 20, задача 10), тощо.
> Номера задач активно використовуються при написанні програмного коду, і дають можливість швидко знайти необхідний, пов'язаний із задачею програмний метод (або зрозуміти що він відсутній):  
> T1010_OnLoad — при завантаженні задачі 1010  
> T1010_OnCh__ProcSubject — при зміні властивості на формі задачі 1010

#### 🔷 Нумерування переходів задач процесу

◻️ Назва переходів із задач на діаграмі процесу теж починається з іх порядкового номеру в форматі `RR` де RR - двоцифровий номер переходу, для наступного переходу номер збільшується на 10. 
> Номер задачі, разом із номером переходу використовується для прив'язки форм, скриптів переходів та скриптів після переходу:  
> • До переходу `20 OK` задачі `[1010] 📥 Підготовка 👤 Ініціатор` прив'язана форма `[1010_20] 📥 В роботу 👤 Ініціатор`  
> • Після переходу `20 OK` задачі `[1010] 📥 Підготовка 👤 Ініціатор` виконується скрипт `T1010_A20__Ok` (зона 10; задача 10; перехід A20, після задачі)  
> • Безпосередньо на сам перехід `20 OK` задачі `[1010] 📥 Підготовка 👤 Ініціатор` може бути прив'язано скрипт `T1010_A20__IsAllowed` (зона 10; задача 10; перехід A20, після задачі), що перевіряє дані форми дозволяє цей перехід чи ні.  

### 🔶 Контекст процесу

#### 🔷 Іменування властивостей контексту процесу

◻️ <ins>Назва властивостей для користувача</ins> із контексту процесу будь-яка, проте зрозумілоа для кінцевого користувача та розробника;  

◻️ <ins>Назва властивостей для пр'ограмного коду</ins> із контексту процесу перекладена на англійську мову (а не транслітерація назви латинськими літерами), тобто не `NazvaVlastyvostyProcesu`, а `NameOfProcessProperty`

#### 🔷 Типи даних, що не використовуються

◻️ В контексті процесу не використовуються властивості з наступними типами даних:  
	- `Випадаючий список` — замісь цього типу даних використовуються `переліки (enum)`, які значно легше контролювати в програмному коді  
	- `Текст` — замісь цього типу даних використовується `Строка (String)` з налаштуванням "Несколько строк: вкл""  
	- `Файл` — замісь цього типу даних використовується `Вложение  `


### 🔶 Діаграма процесу

#### 🔷 Cкрипти процесу

◻️ На діаграмі процесу розміщено скрипти процесу в яких можна обробити типові події процесу —  після запуску `Proc_AS` та перед зупинкою `Proc_BS`:  
> `Proc_AS` (process after start) — після запуску процесу  
> `Proc_BS` (process before stop) — перед зупункою процесу  
> `Proc_BeforeAbort` (process before abort) — перед перериванням процесу ззовні (відсутній на діаграмі, але прив'язаний до відповідної події процесу) 

#### 🔷 Cкрипти задач

◻️ На діаграмі процесу розміщено скрипти задач в яких можна обробити типові події задач - перед задачею `B` (before) та після задачі `A` (after). Додатково із задачею можуть бути пов'язані скрипти під час її виконання чи перед завершенням її виконання.
> Наприклад, для задачі `[1010] 📥 Підготовка 👤 Ініціатор` скрипти  
>  
> ◤ Перед задачею (B, before):  
> `T1010_B10`   
>  
> ◤ Під час виконання:  
> `T1010_OnLoad` — при завантаженні форми задачі  
> `T1010_OnCh__ProcSubject` — при зміні властивості на формі  
> `T1010_OnCh__BL10_PropertyName` (як приклад) — при зміні властивості блока (BL10) на формі  
> `T1010_OnCh__BL10a_PropertyName` (як приклад) — при зміні властивості блока (a), що вкладений в інший блок (BL10) на формі  
>  
> ◤ Перед завершенням виконання :  
> `T1010_A20__IsAllowed` (як приклад) — чи дозволено завершити задачу і виконати перехід (A20)  
>  
> ◤ Після виконання задачі (A, after):  
> `T1010_A00__Break` — Після виконання переходу A00 (відмінено користувачем)   
> `T1010_A01__Abort`  — Після виконання переходу A01 (ескалація по таймеру)  
> `T1010_A10__Save` — Після виконання переходу A10 (оновлення документу процесу і продовження роботи)  
> `T1010_A20__Ok` — Після виконання переходу A20 (підготовка даних для наступного користувача)

### 🔶 Скрипти процесу

#### 🔷 Огранізація коду на верхньому рівні

◻️ Код в скриптах процесу <ins>розділено по класам</ins> у відповідності до функцій, що він виконує:
```cs
namespace EleWise.ELMA.Model.Scripts {
    // Контекст процесу (методи до яких прив'язані обробники вказані на діаграмі процесу)
    public partial class P25076j_SampleProcess_Scripts: EleWise.ELMA.Workflow.Scripts.ProcessScriptBase<Context>  { /*...*/ }
    
    // Константи, що використовуються процесом
    public static class Constants  { /*...*/ }
    
    // Методи розширення для типових операції процесу
    public static class Context__Ext  { /*...*/ }
    
    // Робота з об'єктом конфігурації процесу
    public static class Config__Ext { /*...*/ }
    
    // DTO що містить стартові параметри процесу (Наша компанія, ЦФВ, Департамент, тощо)
    public class ProcessStartInfo: IProcessStartInfo  { /*...*/ }
    
    // Розширення для роботи з сутностями під час генерації документу процесу
    public static class Entity__Ext { /*...*/ }
    
    // Розширення для роботи з статусами процесу
    public static class EProcStatus__Ext { /*...*/ }
    
    // Розширення для роботи із генерацією документу процесу
    public static class ProcDoc__Ext { /*...*/ }

    // DTO що містить дані які використовуються під час генерації документу процесу
    public class StrViewProcDoc { /*...*/ }

    // DTO що містить дані які використовуються під час генерації документу процесу
    public class StrViewProcMbr { /*...*/ }
}
```

#### 🔷 Огранізація коду основного класу процесу

◻️ Код основного класу процесу розділено на блоки, у відповідності до зон процесу та задач, що містяться в них:
```cs
public partial class P25076j_SampleProcess_Scripts: EleWise.ELMA.Workflow.Scripts.ProcessScriptBase<Context> {
    // Обробники типових операцій процесу
    // ▬▬▬▬▬ Proc ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
    public virtual void Proc_AS(Context context) { /*...*/ }

    public virtual void Proc_BS(Context context)  { /*...*/ }

    public virtual void Proc_BeforeAbort(Context context)  { /*...*/ }

    // Обробники форми запуску процесу (що прив'язана до події "Запуск процесу")
    // ▬▬▬▬▬ T0000 ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
    public virtual void T0000_OnLoad(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form)  { /*...*/ }

    public virtual void T0000_OnCh__CFR(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form)  { /*...*/ }

    // Обробники що пов'язані із задачею "[1010] 📥 Підготовка 👤 Ініціатор"
    // ▬▬▬▬▬ T1010 ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
    public virtual void T1010_B10(Context context)  { /*...*/ }

    public virtual void T1010_OnLoad(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form)  { /*...*/ }

    public virtual void T1010_OnCh__ProcSubject(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form)  { /*...*/ }

    public virtual void T1010_A00__Break(Context context) { /*...*/ }

    public virtual void T1010_A01__Abort(Context context) { /*...*/ }

    public virtual void T1010_A10__Save(Context context) { /*...*/ }

    public virtual void T1010_A20__Ok(Context context) { /*...*/ }

    // Обробники що пов'язані із формою для переходу "[1010_20] 📥 В роботу 👤 Ініціатор" (перехід 20 із задачі 1010)
    // ▬▬▬▬▬ T1010_20 ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
    public virtual void T1010_20_OnLoad(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form) { /*...*/ }

    // ▬▬▬▬▬ T1020 ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
    public virtual void T1020_B10(Context context) { /*...*/ }

    public virtual void T1020_OnLoad(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form) { /*...*/ }

    public virtual void T1020_A00__Break(Context context) { /*...*/ }

    public virtual void T1020_A10__Save(Context context)  { /*...*/ }

    public virtual void T1020_A20__Ok(Context context)  { /*...*/ }

    // Обробники що пов'язані із задачею "[2010] 📥 Заключення 👤 Економіст"
    // ▬▬▬▬▬ T2010 ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
    public virtual void T2010_B10(Context context)  { /*...*/ }

    public virtual void T2010_OnLoad(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form)  { /*...*/ }

    public virtual void T2010_A10__Return(Context context)  { /*...*/ }

    public virtual void T2010_A20__Ok(Context context)  { /*...*/ }

    // Обробники що пов'язані із задачею "[3010] 📥 Розгляд 👤 Керівник"
    // ▬▬▬▬▬ T3010 ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
    public virtual void T3010_B10(Context context)  { /*...*/ }

    public virtual void T3010_OnLoad(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form)  { /*...*/ }

    public virtual void T3010_A10__No(Context context)  { /*...*/ }

    public virtual void T3010_A20__Ok(Context context) { /*...*/ }
}
```

#### 🔷 Метаінформація процесу

◻️ Перед основним класом процесу вказано xml-примітки з <ins>метаінформацією про процес</ins>:
- дату збереження процесу (що можна використовувати як версію) та його назву; 
- об'єкти системи, що були використані під час його створення (і можуть знадобитись для його переносу на іншу машину): групи користувачів, сутності, пелеліки, документи, глобальні модулі, додаткові процесі (окрім цього), тощо;  
- дії які потрібно зробити під час або після переносу  
💬 Oб'єкти які потрібно перенести в іншу систему з даними позначено `[+]`
```cs
/// <remarks> 2025-03-19 17-20 • P25076j__SampleProcess
/// • Group of users
///     [ ] ⓿⚙️ Процеси / 25076j ⚙️ SampleProcess / ▶️ Ініціатори
///     [ ]
/// 
/// • Objects
///     [+] ⓿ PC25076o02 🛠️ SampleProcess(Объект) 
///     [+] ⓿❶ 25048m12 📘 TaskId
///     [+] ⓿❶ 25045p44 📘 Учасник процесу
///     [ ]
/// 
/// • Enums
///     [ ] ⓿ E25076j05 🎲 Статус процесу(Перечисление)
///     [ ]
/// 
/// • Documents
///     [ ] ⓿ D25076o19 📜 SampleDoc(Документ)
///     [ ]
/// 
/// • Modules
///     [ ] Kusto.Docflow.Directory
///     [ ] Kusto.Docflow.DocGen
///     [ ] Kusto.Ext.CFR
///     [ ] Kusto.Ext.Department
///     [ ] Kusto.Ext.Elma_Entity
///     [ ] Kusto.Ext.Numerator
///     [ ] Kusto.Ext.Obj25045p44_ProcMember
///     [ ] Kusto.Ext.Sys_DateTime
///     [ ] Kusto.Ext.Sys_Double
///     [ ] Kusto.Ext.Sys_Int
///     [ ] Kusto.Ext.Sys_TimeSpan
///     [ ] Kusto.Ext.System.Url
///     [ ]
///     
/// • Aux processes
///     [ ]
///		
/// ■ TODO
///     [ ] Зкопіювати файл "DT24306n16_ProtocolOfBudgetChanges.xlsx" в папку "C:\KustoDocTemplates\", за необхідності вказати повний шлях до цього файлу в об'єкті конфігурації процесу (PC25076o02 🛠️ SampleProcess)
///		
/// </remarks>
```

#### 🔷 Константи процесу

◻️ Всі <ins>константи</ins>, що використовуються процесом винесено в окремий клас, що передусім містить унікальний ідентифікатор `ProcGuid` що використовується як ідентифікатор процесу і по якому (в разі відсутності) створюється/використовується нумератор процесу та використовується об'єкт конфігурації процесу, 

```cs
public static class Constants {
    public static readonly Guid ProcGuid = new Guid("0195a4a1-f11a-7189-bc83-04892ad669f6");    

    public static class ProcTaskGuid { /* ... */ }
    
    // ...
}
```

#### 🔷 Типові операції процесу

◻️ Методи для типових операції процесу винесено в окремий клас:
```cs
public static class Context__Ext {
    // Завантажити в контекстну змінну об'єкт конфігурації процесу
    public static void SetUpProcConfig(this Context context) { /* ...  */ }

    // Задати фільтр для вказаної змінної з контексту процесу
    public static void FilterOn<TEntity>(this Context context, Expression<Func<Context, TEntity>> propertySelector, String filterQuery) where TEntity : IEntity  { /* ...  */ }

    // Вимкнути фільтр для вказаної змінної з контексту процесу
    public static void FilterOff<TEntity>(this Context context, Expression<Func<Context, TEntity>> propertySelector) where TEntity : IEntity { /* ...  */ }

    // Отримати (та записати в контекстну змінну) номер процесу
    public static void SetUpProcNumber(this Context context) { /* ...  */ }

    // Оновити дату процесу
    public static DateTime UpdateProcDate(this Context context) { /* ...  */ }

    // Отримати (та записати в контекстну змінну) робочу папку процесу (де будуть зберігатись його документи)
    public static void SetUpProcDirectory(this Context context) { /* ...  */ }

    // ...

    // Оновити назву процесу, його статус та докумен
    public static void UpdateProcNameStatusAndDoc(this Context context, EProcStatus? newStatus, String taskCode)  { /* ...  */ }

    // Генерувати DTO що містить стартові параметри процесу (Наша компанія, ЦФВ, Департамент, тощо)
    public static ProcessStartInfo GetProcessStartInfo(this Context context) { /* ...  */ }

    // Отримати із матриці учасників процесу (що міститься в об'єкті конфігурації процесу) виконавця для необхідної задачі процесу
    private static ElmaUsr GetTaskExecutor(this Context context, Guid taskGuid) { /* ...  */ }

    // Отримати (та записати в контекстну змінну) виконавця для задачі 2010 (економіста)
    public static void UpdateTaskExecutor_T2010(this Context context) {
        context.Z20Usr_Economist = context.GetTaskExecutor(Constants.ProcTaskGuid.T2010);
    }

    // Отримати (та записати в контекстну змінну) виконавця для задачі 3010 (Керівника)
    public static void UpdateTaskExecutor_T3010(this Context context) {
        context.Z30Usr_Chief = context.GetTaskExecutor(Constants.ProcTaskGuid.T3010);
    }
}
```

Приклад використання методів цього класу:

```cs
public virtual void Proc_AS(Context context) {
    context.FilterOff(c => c.OurCompany);
    context.FilterOff(c => c.CFR);
    context.FilterOff(c => c.Department);
    //
    context.SetUpProcConfig();
    context.SetUpProcNumber();
    context.UpdateProcDate();
    context.SetUpProcDirectory();
    context.UpdateProcDate();
}
```

#### 🔷 Методи при завантаженні форм

◻️ Код в методах, що використовуються при завантаженні форм повинен бути обгорнутий в блок `try - catch` та у разі помилки виводити повідомлення про помилку на форму:
```cs
public virtual void T0000_OnLoad(Context context, EleWise.ELMA.Model.Views.FormViewBuilder<Context> form) {
    try {
        context.SetUpProcConfig();
        context.FilterOn(c => c.OurCompany, Constants.Filters.SuitableOurCompanies);
        CFR__ExtFilter.FilterOn_ActualObjects(context, c => c.CFR);
    }
    catch(Exception ex) {
        form.Notifier.Error(String.Format("{0} • {1}", ex.Message, ex.StackTrace));
    }
}
```

#### 🔷 Об'єкт конфігурації процесу

◻️ Для контролю над даними, що використовуються в процесі, але можуть змінитись з часом використовується об'єкт конфігурації процесу (його налаштуваннь), куди може бути розміщено інформацію звідки брати шаблон для генерації документу процесу, учасників процесу, тощо. В даному процесі використовується спеціальний клас що працює з об'єктом налаштувань процесу:

```cs
public static class Config__Ext {
    // Отримати інформацію про виконавця задачі
    public static ConfigBL10_Mbrs GetTaskExecutor(this Config config, Guid taskGuid) { /* ... * }
}
```

використання:

```cs
private static ElmaUsr GetTaskExecutor(this Context context, Guid taskGuid) {
    ConfigBL10_Mbrs executorFromConfig = context.ProcConfig.GetTaskExecutor(taskGuid);
    return executorFromConfig == null ? null : executorFromConfig.BI_Mbr.GetExecuto(context.GetProcessStartInfo());
}

public static void UpdateTaskExecutor_T2010(this Context context) {
    context.Z20Usr_Economist = context.GetTaskExecutor(Constants.ProcTaskGuid.T2010);
}

public static void UpdateTaskExecutor_T3010(this Context context) {
    context.Z30Usr_Chief = context.GetTaskExecutor(Constants.ProcTaskGuid.T3010);
}
```

◻️ Основна причина використання об'єкта конфігурації процесу: 
- зберігання матриці учасників процесу що можуть залежати від багатьох різноманітних факторів (Наша компанія, ЦФВ, департамент, сума, і багатьох інших параметрів, в залежності від потреб конкретного процесу)
- Оперативна і централізована зміна учасників процесу -- зміни затронуть всі нові задачі всіх активних процесів, що їх зчитують
- Джерело учасників процесу можна міняти на льоту (Ініціатор процесу, Користувач, Користувач з посади, Організаційна роль, Керівник департаменту, Керівник ЦФО, тощо)

#### 🔷 Генерація документів в процесі

◻️ Під час генерації документів процесу використовується зовнішній файл з шаблоном документу

◻️ Шлях до файлу шаблону документу міститься в об'єкті конфігурації процесу

◻️ Під час генерації документу процесу (друкованої форми) <u>ніколи</u> на пряму не використовуються контекстні змінні. Замісь цього використовується **об'єкт текстового надання інформації**, що містить виключно текстові поля та (за необхідності для таблиць, колекцій, тощо) інші обєкти текстового надання інформації

◻️ Під час створення об'єкту текстового надання інформації - можна гнучно керувати форматуванням інформації та не перейматись за те що зміна назви контекстної змінної чи її видалення "тихо" вплине на генерацію друкованої форми документу процесу

◻️ Під час конвертувань значень контекстних змінних до значень полів об'єкту текстового надання інформації використовуються методи-розширення (із глобальних модулів Kusto.Ext.Sys_Int, Kusto.Ext.Sys_DateTime, Kusto.Ext.Sys_TimeSpan, тощо) що дозволяють гнучко форматувати результуючі значення простих типів даних.

◻️ Окремо слід зазначити що:
- під час генерації друкованої форми документу в елмі в колонтитул документу додається **посилання на сам документ в системі** (завдяки коду із глобального модулю Kusto.Ext.System.Url) -- що дає можливість маючи роздрукований документ оперативно знайти його в системі, та відслідкувати пов'язану з ним інформацію.
- використовується нумератор у вигляді `YYMM_nnnn` (2503_0001) - де YY - рік, MM - місяць, nnnn - порядковий номер документа (в цьому місяці)
- назва документу починається з його абревіатури
- назві документу міститься його статус - щоб не переходячи у сам документ можна було зрозуміти його стан та можливість використання
